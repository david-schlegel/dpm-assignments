---
title: "Plot assignment"
author: "Template: Ian Hussey; content: David Schlegel"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    code_folding: hide
    highlight: haddock
    theme: flatly
    toc: yes
    toc_float: yes
---

# Beschreiben welche Elemente einen guten Plot ausmachen, damit klar wird, was mant macht. Immer genau erklären, warum man etwas macht. Warum man welche Farben, welche Linien, welche Bezeichungen etc. braucht. Im Schlechten alles so machen, dass es möglichst schlecht ist. 
# Keine Restriktionen auf Daten und man irgendeine Geschichte zu den Zahlen erzählen. 
# Nicht zu basic, aber auch nicht to sophisticated, dass man sie in Artikeln nicht finden würde. Z.B. Raincloud Plots sind ok. Sie sollten gut ausschauen und psychologisch relevant sein. 
# Beide sollten etwas aussagen, z.B. ich möchte diese

```{r, include=FALSE}

knitr::opts_chunk$set(message = FALSE,
                      warning = FALSE)

```

# Dependencies

```{r}
library(janitor) 
library(openxlsx)
library(ggplot2)
library(introdataviz)
library(viridis)
library(ggsignif)

```

# Instructions

The goal of this exercise is to produce both good and bad examples of plots *and to be explicit about what makes them good or bad*. 

The data can be real or fabricated. The plots can convey realistic or silly messages - but they must convey them clearly. You can get real data from many sources. A good one is the open science framekwork (osf.io). You can also simply make up data, either by hand or using simulation functions (e.g., `rnorm`) or the many simulation packages. If simulating data, ensure that you (a) use set.seed() to make it reproudbile, and (b) save a copy of the final data that you're using to disk and then reload it in the script so that the plot is reproducible.

The goal is neither to reproduce the types of plots that you most often see in journals (bar plots, etc.) nor to use a very fancy looking plot just for the sake of it - if it is very unlikely that you'd ever be able to use the plot to convey a research finding in an article, blog, poster, tweet, infographic or otherwise, it's probably not a good choice either.

The plots must be reproducible. Provide the data as well as the code to reporduce them. The plots should also be saved as individual images (pdf or png).

Under each plot, here in the RMarkdown, briefly explain what types of analysis the plot is suitable for, what elements of the results the plot attempts to clearly convey. For the bad plot, do the opposite: emphasise what features of the results the plot obscures or makes unclear. In doing so, communicate to me that you understand what makes a good plot to convey the results of quantiative analyses to viewers.

Consider making use of the many extensions to ggplot2, e.g.:

- https://r-graph-gallery.com
- https://krzjoa.github.io/awesome-r-dataviz/#/
- ggdist https://mjskay.github.io/ggdist/
- ggrepel
- ggpubr
- see
- ggsignif
- and others: https://exts.ggplot2.tidyverse.org/gallery/

- osf.io
- AIID dataset: https://osf.io/pcjwf/


# Daten einlesen
```{r}
data_raw <- read_csv("../data/raw/depression_data.csv") |> 
  janitor::clean_names()
```
# Daten konvertieren
```{r}

data_raw$gender <- as.factor(data_raw$gender)

```



# Good plot

```{r}
rain_height <- 0.15

ggplot(data_raw, aes(x = "", y = depression_level, fill = gender)) +
  geom_flat_violin(trim=FALSE, alpha = 0.4, position = position_nudge(x = 0.14),
                   size = 0.3, show.legend = FALSE) +
  geom_point(aes(color = stress_level), size = 2, alpha = .8, show.legend = TRUE,
             position = position_jitter(width = 0.12, height = 0.0)) +
  scale_color_viridis_c(option = "inferno",
                        begin = 0.3, end = 0.9, direction = -1,
                        breaks = c(1,2.5,5,7.5,10)) +
  geom_boxplot(width = rain_height, alpha = 0.4, show.legend = FALSE, 
               outlier.shape = NA,
               position = position_nudge(x = -rain_height*2), 
               size = 0.3) +
  # geom_signif(comparisons = list(c("female", "male")),
  #             map_signif_level = TRUE) +
  facet_wrap(~gender, labeller = as_labeller(c(male = "Male", female = "Female"))) +
  coord_flip() +
  labs(title = "Distribution of Depression Severity by Gender and Stress Level",
       x = "",
       y = "Depression Severity",
       color = "Stress Level") + 
  theme_minimal() +
  scale_fill_viridis_d(option = "mako", begin = 0.4, end = 0.7, direction = -1) +
  guides(fill=FALSE) + 
  theme(strip.text = element_text(size = 12),
        legend.title = element_text(size = 10),
        legend.position = "bottom",
#        legend.position = c(0.5, 0.1),
        legend.direction = "horizontal",
        legend.background = element_rect(fill = "white", colour = "black", size = 0.1)) + # Legende horizontal ausrichten
  guides(color = guide_legend(title.position = "top", title.hjust = 0.5)) 

ggsave("../communication/good.png", bg = "white", width = 20, height = 14, units = "cm")

```

This Plot is a combination of a violin plot, a box plot and a scatter plot also called rainplot. It is suitable for visualizing continuous variables. 

The Violin plot is useful for comparing distributions between different groups - here gender. It shows the density of the depression severity scores at different levels, indicating where values are concentrated.

The Box plot is useful for a summary of the central tendencies of each gender category. It shows clearly that the median of the two groups are different.  

The Scatter plot is helpful to visualize the individual observations of the depression severity scores.  Here it is coloured as well by stress level. This is helpful to identify patterns or outliers and in this specific case to explore the relationship between stress and depression. 

In summary this plot aims to convey the distribution and central tendencies of depression severity by gender and to explore the relation between depression severity and stress levels. 

```{r}
ggplot(data_raw, aes(x = gender, y = depression_level, fill = gender)) +
  geom_flat_violin(trim = FALSE, alpha = 0.4, position = position_nudge(x = 0.2), size = 0.3) +
  geom_point(aes(color = stress_level), size = 2, alpha = .8, 
             position = position_jitter(width = 0.1, height = 0.0)) +
  scale_color_viridis_c(option = "inferno", begin = 0.3, end = 0.9, direction = -1,
                        breaks = c(1,2.5,5,7.5,10)) +
  geom_boxplot(width = rain_height, alpha = 0.4, outlier.shape = NA,
               position = position_nudge(x = -0.2), size = 0.3) +
  geom_signif(comparisons = list(c("female", "male")),
              map_signif_level = TRUE,
              y_position = 13,
              tip_length = 0.02) + 
  coord_flip() +
  labs(title = "Distribution of Depression Severity by Gender and Stress Level",
       x = "",
       y = "Depression Severity",
       color = "Stress Level") + 
  theme_minimal() +
  scale_fill_viridis_d(option = "mako", begin = 0.4, end = 0.7, direction = -1) +
  guides(fill = FALSE, color = guide_legend(title.position = "top", title.hjust = 0.5)) +
  theme(legend.position = "bottom",
        legend.direction = "horizontal",
        legend.background = element_rect(fill = "white", colour = "black", size = 0.1),
        strip.text = element_text(size = 12),
        legend.title = element_text(size = 10), 
        axis.text.y = element_text(size = 12)) +
  scale_x_discrete(labels = c("female" = "Female", "male" = "Male")) 

ggsave("../communication/good_2.png", bg = "white", width = 20, height = 20, units = "cm")


```


# Bad plot

```{r}



 ggsave("../communication/test.jpg")

```

# Write to disk

Write to disk as a .pdf or .png.

Name them "plot_good_[yourname]" and "plot_bad_[yourname]".

```{r}



```

# Session info

```{r}

sessionInfo()

```


